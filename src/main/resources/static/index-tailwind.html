<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Garagem do Condomínio — Nova UI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            bg: {
              900: '#0b1220',
              800: '#0f172a',
              700: '#111827',
              600: '#1f2937'
            }
          },
          keyframes: {
            'fade-in': { '0%': { opacity: 0 }, '100%': { opacity: 1 } },
            'slide-up': { '0%': { opacity: 0, transform: 'translateY(8px)' }, '100%': { opacity: 1, transform: 'translateY(0)' } },
            'pop': { '0%': { transform: 'scale(.98)', opacity: 0 }, '100%': { transform: 'scale(1)', opacity: 1 } },
            'shimmer': {
              '0%': { backgroundPosition: '-200% 0' },
              '100%': { backgroundPosition: '200% 0' }
            },
            'bar': { '0%': { width: '0%' }, '100%': { width: '100%' } },
            'float': {
              '0%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-8px)' },
              '100%': { transform: 'translateY(0px)' }
            },
            'pulse-soft': {
              '0%': { boxShadow: '0 0 0 0 rgba(56,189,248,0.0)' },
              '50%': { boxShadow: '0 0 0 6px rgba(56,189,248,0.15)' },
              '100%': { boxShadow: '0 0 0 0 rgba(56,189,248,0.0)' }
            }
          },
          animation: {
            'fade-in': 'fade-in .4s ease-out both',
            'slide-up': 'slide-up .35s ease-out both',
            'pop': 'pop .25s ease-out both',
            'shimmer': 'shimmer 1.2s linear infinite',
            'bar': 'bar 1.5s ease-in-out infinite',
            'float': 'float 6s ease-in-out infinite',
            'pulse-soft': 'pulse-soft 1s ease-out 1'
          }
        }
      }
    }
  </script>
  <script>
    (function() {
      try {
        const KEY = 'garage_theme';
        const stored = localStorage.getItem(KEY);
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const useDark = stored ? stored === 'dark' : prefersDark;
        if (useDark) document.documentElement.classList.add('dark');
      } catch (e) { /* ignore */ }
    })();
  </script>
</head>
<body class="min-h-screen bg-white text-slate-800 dark:bg-bg-800 dark:text-slate-200">
  <!-- Decorative animated background -->
  <div class="pointer-events-none fixed inset-0 -z-10">
    <div class="absolute -top-24 -left-16 w-72 h-72 bg-sky-400/10 dark:bg-sky-400/15 blur-3xl rounded-full animate-float"></div>
    <div class="absolute -bottom-24 -right-16 w-80 h-80 bg-emerald-400/10 dark:bg-emerald-400/15 blur-3xl rounded-full animate-[float_7s_ease-in-out_infinite]" style="animation-delay:.8s"></div>
  </div>
  <!-- Navbar -->
  <header class="sticky top-0 z-40 backdrop-blur border-b border-slate-200 bg-white/70 dark:border-slate-700 dark:bg-bg-900/70">
    <!-- Loading bar -->
    <div id="loadingBar" class="absolute left-0 top-0 h-0.5 bg-sky-500/80 w-0 transition-[width] duration-500"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <h1 class="text-lg sm:text-xl font-semibold tracking-tight">Garagem do Condomínio</h1>
      <div class="flex items-center gap-3">
        <button id="themeToggle" class="inline-flex items-center text-sm px-2.5 py-2 rounded-full border border-transparent bg-slate-900 text-white hover:bg-slate-800 active:scale-[.98] transition dark:bg-slate-600 dark:hover:bg-slate-500" title="Alternar tema">
          <span id="themeIcon" class="transition-transform" aria-hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="w-4 h-4">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
          </span>
        </button>
        <a href="/" class="text-sm text-slate-500 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-200">UI clássica</a>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <!-- KPIs -->
    <section class="grid grid-cols-1 sm:grid-cols-3 gap-4 animate-fade-in">
      <div class="rounded-xl bg-white border border-slate-200 p-4 transition hover:-translate-y-0.5 hover:shadow-lg/10 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.05s">
        <p class="text-sm text-slate-500 dark:text-slate-400">Total de vagas</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span id="capacidade" data-countup class="text-3xl font-bold">-</span>
          <span class="px-2 py-0.5 text-xs rounded-full bg-slate-200 text-slate-700 dark:bg-slate-700 dark:text-slate-300">Capacidade</span>
        </div>
        <div id="skt-capacidade" class="mt-2 h-4 rounded bg-gradient-to-r from-slate-200/40 via-slate-300/40 to-slate-200/40 bg-[length:200%_100%] animate-[shimmer_1.2s_linear_infinite] dark:from-slate-700/40 dark:via-slate-600/40 dark:to-slate-700/40 hidden"></div>
      </div>
      <div class="rounded-xl bg-white border border-slate-200 p-4 transition hover:-translate-y-0.5 hover:shadow-lg/10 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.1s">
        <p class="text-sm text-slate-500 dark:text-slate-400">Vagas ocupadas</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span id="ocupadas" data-countup class="text-3xl font-bold text-rose-600 dark:text-rose-400">-</span>
          <span class="px-2 py-0.5 text-xs rounded-full bg-rose-100 text-rose-700 dark:bg-rose-900/40 dark:text-rose-300">Ocupadas</span>
        </div>
        <div id="skt-ocupadas" class="mt-2 h-4 rounded bg-gradient-to-r from-slate-200/40 via-slate-300/40 to-slate-200/40 bg-[length:200%_100%] animate-[shimmer_1.2s_linear_infinite] dark:from-slate-700/40 dark:via-slate-600/40 dark:to-slate-700/40 hidden"></div>
      </div>
      <div class="rounded-xl bg-white border border-slate-200 p-4 transition hover:-translate-y-0.5 hover:shadow-lg/10 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.15s">
        <p class="text-sm text-slate-500 dark:text-slate-400">Vagas disponíveis</p>
        <div class="mt-2 flex items-baseline gap-2">
          <span id="disponiveis" data-countup class="text-3xl font-bold text-emerald-600 dark:text-emerald-400">-</span>
          <span class="px-2 py-0.5 text-xs rounded-full bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-300">Disponíveis</span>
        </div>
        <div id="skt-disponiveis" class="mt-2 h-4 rounded bg-gradient-to-r from-slate-200/40 via-slate-300/40 to-slate-200/40 bg-[length:200%_100%] animate-[shimmer_1.2s_linear_infinite] dark:from-slate-700/40 dark:via-slate-600/40 dark:to-slate-700/40 hidden"></div>
      </div>
    </section>

    <!-- Forms -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-6 animate-fade-in" style="animation-delay:.15s">
      <div class="rounded-xl bg-white border border-slate-200 p-5 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.2s">
        <h2 class="text-base font-semibold">Configuração (admin)</h2>
        <p class="text-sm text-slate-500 mt-1 dark:text-slate-400">Ajuste a quantidade total de vagas.</p>
        <div class="mt-4 flex gap-2">
          <input id="capacidadeInput" type="number" min="1" placeholder="Ex: 30"
                 class="w-full rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <button id="btnAtualizarCapacidade" class="rounded-lg px-3 py-2 bg-sky-600 hover:bg-sky-500 active:scale-[.98] transition text-white">Atualizar</button>
        </div>
      </div>

      <div class="rounded-lg bg-white border border-slate-200 p-5 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.25s">
        <h2 class="text-base font-semibold">Registrar Entrada</h2>
        <form id="formEntrada" class="mt-4 grid grid-cols-1 gap-3">
          <input name="nomeCliente" placeholder="Dono do veículo" required
                 class="rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <input name="modelo" placeholder="Modelo do veículo" required
                 class="rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <input name="cor" placeholder="Cor" required
                 class="rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <select name="tipo" id="tipoVeiculo" class="rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 focus:outline-none focus:ring-2 focus:ring-sky-500 dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200">
            <option value="CARRO">Carro</option>
            <option value="MOTO">Moto</option>
            <option value="BIKE">Bike</option>
          </select>
          <p id="bikeHint" class="text-xs text-slate-500 dark:text-slate-400 hidden">Para bikes não é necessário informar placa. Para saída, use o número da vaga.</p>
          <input name="placa" id="placaInput" placeholder="Placa (ABC1234)"
                 class="uppercase rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-sky-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <button type="submit" class="rounded-lg px-3 py-2 bg-emerald-600 hover:bg-emerald-500 active:scale-[.98] transition text-white">Registrar</button>
        </form>
      </div>

      <div class="rounded-lg bg-white border border-slate-200 p-5 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.3s">
        <h2 class="text-base font-semibold">Registrar Saída</h2>
        <form id="formSaida" class="mt-4 grid grid-cols-1 sm:grid-cols-3 gap-2">
          <input name="placa" placeholder="Placa (opcional)"
                 class="uppercase rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-rose-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <input name="numeroVaga" placeholder="Número da vaga (alternativo)" type="number" min="1"
                 class="rounded-lg bg-white border border-slate-300 px-3 py-2 text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-rose-500 transition dark:bg-bg-900 dark:border-slate-700 dark:text-slate-200 dark:placeholder:text-slate-500" />
          <button type="submit" class="rounded-lg px-3 py-2 bg-rose-600 hover:bg-rose-500 active:scale-[.98] transition text-white">Dar baixa</button>
        </form>
      </div>
    </section>

    <!-- Lists -->
    <section class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-6">
      <div class="rounded-xl bg-white border border-slate-200 p-5 transition hover:-translate-y-0.5 hover:shadow-lg/10 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.35s">
        <div class="flex items-center justify-between">
          <h2 class="text-base font-semibold">Vagas Disponíveis</h2>
          <button id="btnAtualizar" class="text-sm rounded-lg px-3 py-2 bg-slate-800 hover:bg-slate-700 active:scale-[.98] transition text-white dark:bg-slate-600 dark:hover:bg-slate-500">Atualizar</button>
        </div>
        <div id="listaVagas" class="mt-4 flex flex-wrap gap-2"></div>
      </div>

      <div class="rounded-xl bg-white border border-slate-200 p-5 transition hover:-translate-y-0.5 hover:shadow-lg/10 dark:bg-bg-700 dark:border-slate-700 animate-slide-up" style="animation-delay:.4s">
        <h2 class="text-base font-semibold">Veículos Estacionados</h2>
        <div class="mt-4 overflow-x-auto">
          <table class="min-w-full text-left text-sm">
            <thead class="text-slate-700 dark:text-slate-300">
              <tr class="border-b border-slate-200 dark:border-slate-700">
                <th class="py-2 pr-4">Vaga</th>
                <th class="py-2 pr-4">Dono do veículo</th>
                <th class="py-2 pr-4">Modelo do veículo</th>
                <th class="py-2 pr-4">Cor</th>
                <th class="py-2 pr-4">Placa</th>
                <th class="py-2 pr-4">Tipo</th>
                <th class="py-2 pr-4">Entrada</th>
                <th class="py-2 pr-4">Ações</th>
              </tr>
            </thead>
            <tbody id="tabelaOcupacoes" class="divide-y divide-slate-100 dark:divide-slate-800"></tbody>
          </table>
          <!-- Skeleton table (shown while carregando) -->
          <div id="skt-tabela" class="mt-3 space-y-2 hidden">
            <div class="h-8 rounded bg-gradient-to-r from-slate-200/40 via-slate-300/40 to-slate-200/40 bg-[length:200%_100%] animate-[shimmer_1.2s_linear_infinite] dark:from-slate-700/40 dark:via-slate-600/40 dark:to-slate-700/40"></div>
            <div class="h-8 rounded bg-gradient-to-r from-slate-200/40 via-slate-300/40 to-slate-200/40 bg-[length:200%_100%] animate-[shimmer_1.2s_linear_infinite] dark:from-slate-700/40 dark:via-slate-600/40 dark:to-slate-700/40"></div>
            <div class="h-8 rounded bg-gradient-to-r from-slate-200/40 via-slate-300/40 to-slate-200/40 bg-[length:200%_100%] animate-[shimmer_1.2s_linear_infinite] dark:from-slate-700/40 dark:via-slate-600/40 dark:to-slate-700/40"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Toast container -->
  <div id="toast-container" class="fixed top-3 left-1/2 -translate-x-1/2 z-50 space-y-2"></div>

  <!-- Modal de Vaga Ocupada -->
  <div id="modalVaga" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/50" id="modalBackdrop"></div>
    <div class="relative max-w-md mx-auto mt-32 rounded-xl border border-slate-200 bg-white p-5 text-slate-800 shadow-xl animate-pop dark:border-slate-700 dark:bg-bg-700 dark:text-slate-200">
      <div class="flex items-start justify-between">
        <h3 class="text-lg font-semibold">Detalhes da vaga</h3>
        <button id="modalClose" class="px-2 py-1 rounded-md text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800">✕</button>
      </div>
      <div id="modalInfo" class="mt-3 text-sm space-y-1"></div>
      <div class="mt-4 flex justify-end gap-2">
        <button id="modalBaixaBtn" class="rounded-lg px-3 py-2 bg-rose-600 hover:bg-rose-500 text-white">Dar baixa</button>
      </div>
    </div>
  </div>

  <script src="app-tailwind.js"></script>
</body>
</html>
